male_names([
"James","John","Robert","Michael","William","David","Richard","Charles","Joseph","Thomas",
"Christopher","Daniel","Paul","Mark","Donald","George","Kenneth","Steven","Edward","Brian",
"Ronald","Anthony","Kevin","Jason","Matthew","Gary","Timothy","Jose","Larry","Jeffrey",
"Frank","Scott","Eric","Stephen","Andrew","Raymond","Gregory","Joshua","Jerry","Dennis",
"Walter","Patrick","Peter","Harold","Douglas","Henry","Carl","Arthur","Ryan","Roger",
"Joe","Juan","Jack","Albert","Jonathan","Justin","Terry","Gerald","Keith","Samuel",
"Willie","Ralph","Lawrence","Nicholas","Roy","Benjamin","Bruce","Brandon","Adam","Harry",
"Fred","Wayne","Billy","Steve","Louis","Jeremy","Aaron","Randy","Howard","Eugene",
"Carlos","Russell","Bobby","Victor","Martin","Ernest","Phillip","Todd","Jesse","Craig",
"Alan","Shawn","Clarence","Sean","Philip","Chris","Johnny","Earl","Jimmy","Antonio",
"Danny","Bryan","Tony","Luis","Mike","Stanley","Leonard","Nathan","Dale","Manuel",
"Rodney","Curtis","Norman","Allen","Marvin","Vincent","Glenn","Jeffery","Travis","Jeff",
"Chad","Jacob","Lee","Melvin","Alfred","Kyle","Francis","Bradley","Jesus","Herbert",
"Frederick","Ray","Joel","Edwin","Don","Eddie","Ricky","Troy","Randall","Barry",
"Alexander","Bernard","Mario","Leroy","Francisco","Marcus","Micheal","Theodore","Clifford","Miguel",
"Oscar","Jay","Jim","Tom","Calvin","Alex","Jon","Ronnie","Bill","Lloyd",
"Tommy","Derek","Warren","Darrell","Jerome","Floyd","Leo","Alvin","Tim","Wesley",
"Gordon","Dean","Jorge","Dustin","Pedro","Derrick","Dan","Lewis","Zachary","Corey",
"Herman","Maurice","Vernon","Roberto","Clyde","Glen","Hector","Shane","Ricardo","Sam",
"Rick","Lester","Brent","Ramon","Charlie","Tyler","Gilbert","Gene","Marc","Reginald",
"Ruben","Brett","Angel","Nathaniel","Rafael","Leslie","Edgar","Milton","Raul","Ben",
"Chester","Cecil","Duane","Franklin","Andre","Elmer","Brad","Gabriel","Ron","Mitchell",
"Roland","Arnold","Harvey","Jared","Adrian","Karl","Cory","Claude","Erik","Darryl",
"Jamie","Neil","Javier","Guy","Wade","Raymon","Rickey","Trevor","Fidel","Manny",
"Salvador","Jonathon","Alfonso","Everett","Kelvin","Wilbur","Darwin","Jeremiah","Darnell",
"Emanuel","Lonnie","Clinton","Garrett","Jessie","Rene","Sherman","Vance","Vito","Cesar",
"Conrad","Damon","Dominic","Eldon","Elijah","Emmett","Ethan","Freddie","Gerard","Grover",
"Irvin","Ivan","Jimmie","Kurt","Lance","Leland","Leonardo","Marshall","Nelson","Nicolas",
"Noel","Oliver","Robbie","Rocky","Rodger","Rufus","Santiago","Sergio","Spencer","Stacy",
"Stephan","Stevenson","Sylvester","Ted","Terrance","Terrence","Tobias","Tracy","Trenton",
"Tyrell","Ulysses","Valentino","Van","Virgil","Wallace","Willard","Wilfred","Xavier",
"Yusuf","Zane","Zion","Abel"
]).

female_names([
"Mary","Patricia","Linda","Barbara","Elizabeth","Jennifer","Maria","Susan","Margaret","Dorothy",
"Lisa","Nancy","Karen","Betty","Helen","Sandra","Donna","Carol","Ruth","Sharon",
"Michelle","Laura","Sarah","Kimberly","Deborah","Jessica","Shirley","Cynthia","Angela","Melissa",
"Brenda","Amy","Anna","Rebecca","Virginia","Kathleen","Pamela","Martha","Debra","Amanda",
"Stephanie","Carolyn","Christine","Marie","Janet","Catherine","Frances","Ann","Joyce","Diane",
"Alice","Julie","Heather","Teresa","Doris","Gloria","Evelyn","Jean","Cheryl","Mildred",
"Katherine","Joan","Ashley","Judith","Rose","Janice","Kelly","Nicole","Judy","Christina",
"Kathy","Theresa","Beverly","Denise","Tammy","Irene","Jane","Lori","Rachel","Marilyn",
"Andrea","Kathryn","Louise","Sara","Anne","Jacqueline","Wanda","Bonnie","Julia","Ruby",
"Lois","Tina","Phyllis","Norma","Paula","Diana","Annie","Lillian","Emily","Robin",
"Peggy","Crystal","Gladys","Rita","Dawn","Connie","Florence","Tracy","Edna","Tiffany",
"Carmen","Rosa","Cindy","Grace","Wendy","Victoria","Edith","Kim","Sherry","Sylvia",
"Josephine","Thelma","Shannon","Sheila","Ethel","Ellen","Elaine","Marjorie","Carrie","Charlotte",
"Monica","Esther","Pauline","Emma","Juanita","Anita","Rhonda","Hazel","Amber","Eva",
"Debbie","April","Leslie","Clara","Lucille","Joanne","Eleanor","Valerie","Danielle","Megan",
"Alicia","Suzanne","Michele","Gail","Bertha","Darlene","Veronica","Jill","Erin",
"Geraldine","Lauren","Cathy","Joann","Lorraine","Lynn","Sally","Regina","Erica","Beatrice",
"Dolores","Bernice","Audrey","Yvonne","Annette","June","Samantha","Marion","Dana","Ana",
"Margie","Holly","Sue","Vanessa","Melinda","Charlene","Lorena","Bobbie","Vicki","Christy",
"Tami","Shari","Eileen","Leona","Tonya","Kay","Minnie","Patty","Shelly","Dorothea","Kristen",
"Emma","Tasha","Candace","Faye","Latoya","Kristine","Cecilia","Raquel","Hilda","Gina","Gwendolyn",
"Mona","Paige","Darla","Lynda","Karla","Elena","Carla","Marcie","Casey","Harriet","Leah","Penny",
"Olga","Katie","Kristi","Sonya","Jacquelyn","Valarie","Lorri","Pat","Billie","Dena","Lana",
"Yolanda","Vicky","Renee","Delores","Becky","Tamara","Jeanne","Olivia","Abigail","Marlene",
"Krista","Sheryl","Leanne","Brittany","Paulina","Kerry","Daphne","Verna","Suzette","Lillie",
"Geneva","Mabel","Marguerite","Hattie","Sabrina","Nora","Estelle","Adeline","Adele","Shelley",
"Melanie","Sonja","Deanna","Patrica","Rochelle","Constance","Tonia","Gretchen","Toni","Marissa",
"Eloise","Maggie","Sondra","Shanna","Kristin","Marsha","Miriam","Traci","Odessa","Celeste",
"Hannah","Jana","Kristy","Alma","Teri","Lucia","Kari","Cathleen","Beulah","Priscilla","Myrna",
"Marian","Alyssa","Shelia","Candi","Karin","Nadine","Christie","Betsy","Joni","Wilma","Dianna",
"Claudia","Roxanne","Kellie","Meredith","Cleo","Lynne","Carmella","Debora","Angelina","Faith",
"Bobbi","Tammi","Debby","Sherrie","Jennie","Maritza","Annmarie","Rosalie","Jeanette","Elisa",
"Vickie","Carole","Angelica","Rosie","Miriam","Tanya","Stacie","Velma","Elvira","Carolina",
"Lorna","Genevieve","Amelia","Joanna","Maureen","Alison","Shelby","Roselyn","Dee","Faith",
"Jennifer","Leigh","Kirsten","Iris","Jeanine","Susie","Doreen","Angie","Lacey","Jo","Cathryn",
"Marcy","Rosalind","Rachael","Jasmine","Sonia","Janelle","Ramona","Wilhelmina","Ashley","Molly",
"Lora","Francine","Cassandra","Tasha","Ginger","Felicia"
]).


:- use_module(library(random)).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Entry point
% generate_family(+Generations, +FileName)
% Generations: number of generations to generate
% FileName: output .pl file containing male/female/parent/married facts
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
generate_family(Generations, FileName) :-
    male_names(MN),
    female_names(FN),
    open(FileName, write, Stream),

    % --- Generation 1: create first couple ---
    random_member(FirstMale, MN),
    random_member(FirstFemale, FN),
    atomic_list_concat([FirstMale, '_', 1], MaleName),
    atomic_list_concat([FirstFemale, '_', 1], FemaleName),

    % write first couple to file
    write(Stream, "male("), write(Stream, MaleName), write(Stream, ").\n"),
    write(Stream, "female("), write(Stream, FemaleName), write(Stream, ").\n"),
    write(Stream, "married("), write(Stream, MaleName), write(Stream, ", "), write(Stream, FemaleName), write(Stream, ").\n"),

    % initial couple list: [Father, Mother]
    InitialCouple = [[MaleName, FemaleName]],

    % pass Stream through recursion
    generate_generation(2, Generations, InitialCouple, Stream),

    close(Stream).  % close the file only at the end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Recursive generation of family tree
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
generate_generation(Current, Max, Couples, Stream) :-
    Current =< Max,
    % generate children for each couple
    findall([ChildName, Gender],
        (member([Father, Mother], Couples),
         random_between(1,3,NumChildren),  % random 1-3 children
         create_children(Father, Mother, Current, NumChildren, ChildList),
         member([ChildName, Gender], ChildList)
        ),
        Children),

    % write facts for each child
    forall(member([ChildName, Gender], Children),
        ( write(Stream, Gender), write(Stream, "("), write(Stream, ChildName), write(Stream, ").\n"),
          member([Father, Mother], Couples),
          write(Stream, "parent("), write(Stream, Father), write(Stream, ", "), write(Stream, ChildName), write(Stream, ").\n"),
          write(Stream, "parent("), write(Stream, Mother), write(Stream, ", "), write(Stream, ChildName), write(Stream, ").\n")
        )),

    % optionally add new people in the generation
    maybe_add_new_people(Children, Stream, Current, NewCouples),

    % prepare couples for next generation
    append(Children, NewCouples, NextGenPeople),
    pair_generation(NextGenPeople, NextCouples),

    % recursive call
    NextCurrent is Current + 1,
    generate_generation(NextCurrent, Max, NextCouples, Stream).

generate_generation(Current, Max, _, _) :-
    Current > Max.  % stop recursion

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Create children for a couple
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
create_children(_, _, _, 0, []) :- !.
create_children(Father, Mother, GenNum, N, [[ChildName, Gender]|Rest]) :-
    % random gender
    (random_float < 0.5 -> Gender = male ; Gender = female),

    % random name based on gender
    ( Gender = male -> male_names(MN), random_member(Name, MN)
    ; female_names(FN), random_member(Name, FN)
    ),
    atomic_list_concat([Name, '_', GenNum], ChildName),
    N1 is N - 1,
    create_children(Father, Mother, GenNum, N1, Rest).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Optionally add new people to generation (married to children)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
maybe_add_new_people([], _, _, []).
maybe_add_new_people(Children, Stream, GenNum, NewCouples) :-
    random_between(0,2,NumNew),
    maybe_add_new_people_helper(NumNew, Children, Stream, GenNum, [], NewCouples).

maybe_add_new_people_helper(0, _, _, _, Acc, Acc) :- !.
maybe_add_new_people_helper(N, Children, Stream, GenNum, Acc, NewCouples) :-
    (random_float < 0.5 -> Gender = male ; Gender = female),
    ( Gender = male -> male_names(MN), random_member(Name, MN)
    ; female_names(FN), random_member(Name, FN)
    ),
    atomic_list_concat([Name, '_', GenNum], NewName),
    write(Stream, Gender), write(Stream, "("), write(Stream, NewName), write(Stream, ").\n"),

    % pick a random child from this generation to marry
    random_member([PartnerName,_], Children),
    write(Stream, "married("), write(Stream, NewName), write(Stream, ", "), write(Stream, PartnerName), write(Stream, ").\n"),

    N1 is N - 1,
    maybe_add_new_people_helper(N1, Children, Stream, GenNum, [[NewName, Gender]|Acc], NewCouples).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Pair males and females for next generation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
pair_generation(People, Couples) :-
    include(is_male, People, Males),
    include(is_female, People, Females),
    pair_lists(Males, Females, Couples).

pair_lists([], _, []).
pair_lists(_, [], []).
pair_lists([[MName,_]|Ms], [[FName,_]|Fs], [[MName,FName]|Rest]) :-
    pair_lists(Ms, Fs, Rest).

is_male([_,male]).
is_female([_,female]).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% generate_samples_random(+NumSamples)
% create multiple family trees with random generations (1-20)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
generate_samples_random(NumSamples) :-
    generate_samples_random_helper(1, NumSamples).

generate_samples_random_helper(Current, NumSamples) :-
    Current > NumSamples, !.
generate_samples_random_helper(Current, NumSamples) :-
    random_between(1,20,Generations),
    format(atom(FileName), 't~|~`0t~d~2+.pl', [Current]),
    generate_family(Generations, FileName),
    Next is Current + 1,
    generate_samples_random_helper(Next, NumSamples).
